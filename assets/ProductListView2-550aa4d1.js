import{_ as B,W as _,S,X as N,I as D,f as d,g as h,i as m,j as c,l as s,u as F,t as C,Y as w,Z as E,$ as j,m as b,q as I,D as P,k as q,a0 as H,T as x,U as k,a1 as W,J as z,v as K,x as U}from"./index-aeb0aaad.js";import{W as J,b as M,S as X,g as Y,a as Z}from"./WebHeader-4b69b183.js";import{B as A}from"./Breadcrumbs-81791c7a.js";import{P as G}from"./Pagination-da2eab0d.js";import{F as Q,_ as $}from"./ic_menu-9d1feb47.js";import{P as ee}from"./ProductCard-a0dd0d8a.js";import{E as te}from"./ErrorLayout-925dbb94.js";import"./VImageError-6b449cbe.js";import"./VImageLoading-af38f523.js";const se={components:{WebHeader:J,WebFooter:M,FilterProduct:Q,Breadcrumbs:A,ProductCard:ee,Pagination:G,SquareSpinner:X,ErrorLayout:te},setup(){function e(l,u){var g=[{title:"Trang chủ",disabled:!1,href:z.path}];return l&&u?(g.push({title:l,disabled:!1,params:{category1:x(l)},name:k.name}),g.push({title:u,disabled:!0})):l&&g.push({title:l,disabled:!0,params:{category1:x(l)},name:k.name}),g}const t=_(S().params.category1),n=_(S().params.category2),i={category1:t,category2:n};let o=e(t,n),r=N();var f=r.currentPage,v=r.searchText;return{category1:t,category2:n,category:i,breadcrumbItems:o,initBreadcrumbsItems:e,productStore:r,currentPage:f,searchText:v}},beforeRouteUpdate(e){this.category1=_(e.params.category1),this.category2=_(e.params.category2),this.category={category1:this.category1,category2:this.category2},this.breadcrumbItems=this.initBreadcrumbsItems(this.category1,this.category2),this.currentPage=this.productStore.currentPage,this.searchText=this.productStore.searchText},data(){return{products:[],isLoading:!1,error:null,reloadProducts:null,selectedDosageForms:[],selectedBrands:[],selectedOrigins:[],pageSum:10,isSearchFocus:!1,filterItemRemove:null,isFilterNavShow:!1}},watch:{filteredValues:{handler(e){this.getProductsList(e)},deep:!0},isFilterNavShow(e){e?document.documentElement.style.overflow="hidden":document.documentElement.style.overflow="scroll"}},computed:{filteredValues(){return{category1:this.category1,category2:this.category2,dosageForms:this.selectedDosageForms.join(","),brands:this.selectedBrands.join(","),origins:this.selectedOrigins.join(",")}},filteredItems(){var e=[];return this.selectedDosageForms&&e.push(...this.selectedDosageForms.map(t=>({type:"dosage",value:t}))),this.selectedBrands&&e.push(...this.selectedBrands.map(t=>({type:"brand",value:t}))),this.selectedOrigins&&e.push(...this.selectedOrigins.map(t=>({type:"origin",value:t}))),e}},methods:{onSelectPage(e){this.currentPage=e,this.changePage(e)},onFilterItemClick(){this.currentPage=1,this.productStore.saveCurrentPage(1)},onFilterValueChange(e,t,n){this.selectedBrands=t,this.selectedDosageForms=e,this.selectedOrigins=n},search(){this.currentPage=1,this.productStore.saveCurrentPage(1),this.productStore.saveSearchText(this.searchText),this.getProductsList(this.filteredValues)},onCloseSearch(){this.searchText="",this.search()},onRemoveFilterItem(e){this.filterItemRemove=e},getProductsList(e){if(window.scrollTo({top:0,left:0,behavior:"instant"}),e.category1=="Sản phẩm nổi bật"){const{isLoading:t,error:n,products:i,reloadHotProducts:o,pageSum:r}=Y(this.currentPage,12,e.category1,e.category2,e.dosageForms,e.brands,e.origins,this.searchText);this.isLoading=t,this.error=n,this.products=i,this.reloadProducts=o,this.pageSum=r}else{const{isLoading:t,error:n,products:i,reloadProducts:o,pageSum:r}=Z(this.currentPage,12,e.category1,e.category2,e.dosageForms,e.brands,e.origins,this.searchText);this.isLoading=t,this.error=n,this.products=i,this.reloadProducts=o,this.pageSum=r}},reload(){this.reloadProducts()},changePage(e){this.currentPage=e,this.productStore.saveCurrentPage(e),this.getProductsList(this.filteredValues)},showProductInfo(e){this.$router.push({name:D.name,params:{id:e.id}})}}},p=e=>(K("data-v-ecad9ab6"),e=e(),U(),e),re={class:"container"},oe={class:"row"},ae={class:"col-3 d-none d-xl-block"},ie={class:"col-12 col-xl-9"},ce={class:"products-header row"},ne={class:"product-category col-12 col-lg-6"},le=p(()=>s("img",{src:$,alt:"",class:"product-category__img"},null,-1)),de={class:"product-category__title"},ue={class:"col-12 col-lg-6 search-bar-container"},he={class:"search-bar__icon"},me={key:0,class:"filter-value-container"},ge=p(()=>s("p",null,"Lọc theo",-1)),_e=["onClick"],pe={class:"filter-chip__title"},fe={class:"filter-chip__close"},ve={key:1},ye={class:"row gx-2 gy-2 gx-lg-3 gy-lg-3 m-b-32"},be=["onClick"],Pe={class:"row product-pagination"},Se=p(()=>s("div",{class:"col-md-3"},null,-1)),Fe={key:0,class:"nav-background"},Ce={class:"nav"},we=p(()=>s("div",{class:"nav-header"},[s("p",{class:"nav-header__title"},"Lọc sản phẩm")],-1)),Ie={class:"nav-content"};function xe(e,t,n,i,o,r){const f=d("web-header"),v=d("breadcrumbs"),l=d("filter-product"),u=d("font-awesome-icon"),g=d("square-spinner"),L=d("error-layout"),T=d("product-card"),O=d("pagination"),V=d("web-footer");return h(),m(b,null,[c(f),s("div",re,[c(v,{class:"m-b-16",items:i.breadcrumbItems},null,8,["items"]),s("div",oe,[s("div",ae,[c(l,{id:"filter-product",category:i.category,filterItemRemove:o.filterItemRemove,onOnFilterItemClick:r.onFilterItemClick,onOnFilterValueChange:r.onFilterValueChange},null,8,["category","filterItemRemove","onOnFilterItemClick","onOnFilterValueChange"])]),s("div",ie,[s("div",ce,[s("div",ne,[le,s("p",de,F(i.category.category2),1)]),s("div",ue,[s("div",{class:C(["search-bar",{"search-bar--focus":o.isSearchFocus}])},[s("div",he,[c(u,{icon:"search"})]),w(s("input",{type:"text",name:"",id:"","onUpdate:modelValue":t[0]||(t[0]=a=>i.searchText=a),placeholder:"Tìm kiếm",onFocus:t[1]||(t[1]=a=>o.isSearchFocus=!0),onBlur:t[2]||(t[2]=a=>o.isSearchFocus=!1),onKeydown:t[3]||(t[3]=j((...a)=>r.search&&r.search(...a),["enter"])),onKeypress:t[4]||(t[4]=(...a)=>r.search&&r.search(...a))},null,544),[[E,i.searchText]]),s("div",{class:C(["search-bar__close",{"d-none":i.searchText==""||i.searchText===void 0||i.searchText===null}]),onClick:t[5]||(t[5]=(...a)=>r.onCloseSearch&&r.onCloseSearch(...a))},[c(u,{icon:"close"})],2)],2),s("div",{class:"filter-button d-flex d-xl-none",onClick:t[6]||(t[6]=a=>o.isFilterNavShow=!0)},[c(u,{icon:"filter",size:"xl"})])])]),r.filteredItems.length>0?(h(),m("div",me,[ge,(h(!0),m(b,null,I(r.filteredItems,(a,y)=>(h(),m("div",{class:"filter-chip",key:y,onClick:R=>r.onRemoveFilterItem(a)},[s("p",pe,F(a.value),1),s("div",fe,[c(u,{icon:"close"})])],8,_e))),128))])):P("",!0),c(g,{isLoading:o.isLoading,height:"512px"},null,8,["isLoading"]),c(L,{error:o.error,onOnRetry:r.reload},null,8,["error","onOnRetry"]),!o.isLoading&&!o.error?(h(),m("div",ve,[s("div",ye,[(h(!0),m(b,null,I(o.products,(a,y)=>(h(),m("div",{ref_for:!0,ref:"product-card",id:"product-card",class:"col-6 col-md-4 col-lg-4",key:y,onClick:R=>r.showProductInfo(a)},[c(T,{class:"h-100 w-100",product:a},null,8,["product"])],8,be))),128))]),s("div",Pe,[Se,c(O,{class:"col-md-6",numberPages:o.pageSum,currentPage:i.currentPage,onOnSelectPage:r.onSelectPage},null,8,["numberPages","currentPage","onOnSelectPage"])])])):P("",!0)])])]),o.isFilterNavShow?(h(),m("div",Fe)):P("",!0),c(H,{name:"slide"},{default:q(()=>[w(s("div",Ce,[s("button",{class:"nav__close-btn",onClick:t[7]||(t[7]=a=>o.isFilterNavShow=!1)},[c(u,{icon:"xmark",size:"2x",style:{color:"white"}})]),we,s("div",Ie,[c(l,{category:i.category,filterItemRemove:o.filterItemRemove,onOnFilterItemClick:r.onFilterItemClick,onOnFilterValueChange:r.onFilterValueChange},null,8,["category","filterItemRemove","onOnFilterItemClick","onOnFilterValueChange"])])],512),[[W,o.isFilterNavShow]])]),_:1}),c(V)],64)}const Ee=B(se,[["render",xe],["__scopeId","data-v-ecad9ab6"]]);export{Ee as default};
