import{_ as B,O as _,K as S,P as N,x as D,a as d,o as h,c as m,b as c,d as r,t as F,n as C,Q as w,R as E,S as q,e as P,f as I,q as b,w as H,T as U,L as x,M as k,U as W,y as j,p as z,h as K}from"./index-c8d0b614.js";import{W as M,g as Q,a as A}from"./WebHeader-1f228ff2.js";import{B as G}from"./Breadcrumbs-ab46c49e.js";import{P as J}from"./Pagination-78dcdc2a.js";import{F as X,_ as Y}from"./ic_menu-afdaaade.js";import{P as Z}from"./ProductCard-1dd49e6c.js";import{W as $}from"./text-banner-097a7b20.js";import"./array-6b9e4775.js";import{S as ee}from"./SquareSpinner-0344fe63.js";import{E as te}from"./ErrorLayout-0152c7e7.js";import"./logo-header-14fc0ac9.js";import"./index-c504ce58.js";import"./compute-img-size-b625a462.js";import"./VImageError-f32d453b.js";import"./VImageLoading-2a8aeaf9.js";const re={components:{WebHeader:M,WebFooter:$,FilterProduct:X,Breadcrumbs:G,ProductCard:Z,Pagination:J,SquareSpinner:ee,ErrorLayout:te},setup(){console.log("LIST SETUP");function e(l,u){var g=[{title:"Trang chủ",disabled:!1,href:j.path}];return l&&u?(g.push({title:l,disabled:!1,params:{category1:x(l)},name:k.name}),g.push({title:u,disabled:!0})):l&&g.push({title:l,disabled:!0,params:{category1:x(l)},name:k.name}),g}const t=_(S().params.category1),n=_(S().params.category2),i={category1:t,category2:n};let o=e(t,n),s=N();var f=s.currentPage,v=s.searchText;return{category1:t,category2:n,category:i,breadcrumbItems:o,initBreadcrumbsItems:e,productStore:s,currentPage:f,searchText:v}},beforeRouteUpdate(e){console.log("to list",e),this.category1=_(e.params.category1),this.category2=_(e.params.category2),this.category={category1:this.category1,category2:this.category2},this.breadcrumbItems=this.initBreadcrumbsItems(this.category1,this.category2),this.currentPage=this.productStore.currentPage,this.searchText=this.productStore.searchText},data(){return{products:[],isLoading:!1,error:null,reloadProducts:null,selectedDosageForms:[],selectedBrands:[],selectedOrigins:[],pageSum:10,isSearchFocus:!1,filterItemRemove:null,isFilterNavShow:!1}},watch:{filteredValues:{handler(e){this.getProductsList(e)},deep:!0},isFilterNavShow(e){e?document.documentElement.style.overflow="hidden":document.documentElement.style.overflow="scroll"}},computed:{filteredValues(){return{category1:this.category1,category2:this.category2,dosageForms:this.selectedDosageForms.join(","),brands:this.selectedBrands.join(","),origins:this.selectedOrigins.join(",")}},filteredItems(){var e=[];return this.selectedDosageForms&&e.push(...this.selectedDosageForms.map(t=>({type:"dosage",value:t}))),this.selectedBrands&&e.push(...this.selectedBrands.map(t=>({type:"brand",value:t}))),this.selectedOrigins&&e.push(...this.selectedOrigins.map(t=>({type:"origin",value:t}))),e}},methods:{onSelectPage(e){this.currentPage=e,this.changePage(e)},onFilterItemClick(){this.currentPage=1,this.productStore.saveCurrentPage(1)},onFilterValueChange(e,t,n){this.selectedBrands=t,this.selectedDosageForms=e,this.selectedOrigins=n},search(){this.currentPage=1,this.productStore.saveCurrentPage(1),this.productStore.saveSearchText(this.searchText),this.getProductsList(this.filteredValues)},onCloseSearch(){this.searchText="",this.search()},onRemoveFilterItem(e){this.filterItemRemove=e},getProductsList(e){if(window.scrollTo({top:0,left:0,behavior:"instant"}),e.category1=="Sản phẩm nổi bật"){const{isLoading:t,error:n,products:i,reloadHotProducts:o,pageSum:s}=Q(this.currentPage,12,e.category1,e.category2,e.dosageForms,e.brands,e.origins,this.searchText);this.isLoading=t,this.error=n,this.products=i,this.reloadProducts=o,this.pageSum=s}else{const{isLoading:t,error:n,products:i,reloadProducts:o,pageSum:s}=A(this.currentPage,12,e.category1,e.category2,e.dosageForms,e.brands,e.origins,this.searchText);this.isLoading=t,this.error=n,this.products=i,this.reloadProducts=o,this.pageSum=s}},reload(){this.reloadProducts()},changePage(e){this.currentPage=e,this.productStore.saveCurrentPage(e),this.getProductsList(this.filteredValues)},showProductInfo(e){this.$router.push({name:D.name,params:{id:e.id}})}}},p=e=>(z("data-v-7f505a0b"),e=e(),K(),e),se={class:"container"},oe={class:"row"},ie={class:"col-3 d-none d-xl-block"},ae={class:"col-12 col-xl-9"},ce={class:"products-header row"},ne={class:"product-category col-12 col-lg-6"},le=p(()=>r("img",{src:Y,alt:"",class:"product-category__img"},null,-1)),de={class:"product-category__title"},ue={class:"col-12 col-lg-6 search-bar-container"},he={class:"search-bar__icon"},me={key:0,class:"filter-value-container"},ge=p(()=>r("p",null,"Lọc theo",-1)),_e=["onClick"],pe={class:"filter-chip__title"},fe={class:"filter-chip__close"},ve={key:1},ye={class:"row gx-2 gy-2 gx-lg-3 gy-lg-3 m-b-32"},Pe=["onClick"],be={class:"row product-pagination"},Se=p(()=>r("div",{class:"col-md-2"},null,-1)),Fe={key:0,class:"nav-background"},Ce={class:"nav"},we=p(()=>r("div",{class:"nav-header"},[r("p",{class:"nav-header__title"},"Lọc sản phẩm")],-1)),Ie={class:"nav-content"};function xe(e,t,n,i,o,s){const f=d("web-header"),v=d("breadcrumbs"),l=d("filter-product"),u=d("font-awesome-icon"),g=d("square-spinner"),L=d("error-layout"),T=d("product-card"),O=d("pagination"),V=d("web-footer");return h(),m(P,null,[c(f),r("div",se,[c(v,{class:"m-b-16",items:i.breadcrumbItems},null,8,["items"]),r("div",oe,[r("div",ie,[c(l,{id:"filter-product",category:i.category,filterItemRemove:o.filterItemRemove,onOnFilterItemClick:s.onFilterItemClick,onOnFilterValueChange:s.onFilterValueChange},null,8,["category","filterItemRemove","onOnFilterItemClick","onOnFilterValueChange"])]),r("div",ae,[r("div",ce,[r("div",ne,[le,r("p",de,F(i.category.category1),1)]),r("div",ue,[r("div",{class:C(["search-bar",{"search-bar--focus":o.isSearchFocus}])},[r("div",he,[c(u,{icon:"search"})]),w(r("input",{type:"text",name:"",id:"","onUpdate:modelValue":t[0]||(t[0]=a=>i.searchText=a),placeholder:"Tìm kiếm",onFocus:t[1]||(t[1]=a=>o.isSearchFocus=!0),onBlur:t[2]||(t[2]=a=>o.isSearchFocus=!1),onKeydown:t[3]||(t[3]=q((...a)=>s.search&&s.search(...a),["enter"]))},null,544),[[E,i.searchText]]),r("div",{class:C(["search-bar__close",{"d-none":i.searchText==""||i.searchText===void 0||i.searchText===null}]),onClick:t[4]||(t[4]=(...a)=>s.onCloseSearch&&s.onCloseSearch(...a))},[c(u,{icon:"close"})],2)],2),r("div",{class:"filter-button d-flex d-xl-none",onClick:t[5]||(t[5]=a=>o.isFilterNavShow=!0)},[c(u,{icon:"filter",size:"xl"})])])]),s.filteredItems.length>0?(h(),m("div",me,[ge,(h(!0),m(P,null,I(s.filteredItems,(a,y)=>(h(),m("div",{class:"filter-chip",key:y,onClick:R=>s.onRemoveFilterItem(a)},[r("p",pe,F(a.value),1),r("div",fe,[c(u,{icon:"close"})])],8,_e))),128))])):b("",!0),c(g,{isLoading:o.isLoading,height:"512px"},null,8,["isLoading"]),c(L,{error:o.error,onOnRetry:s.reload},null,8,["error","onOnRetry"]),!o.isLoading&&!o.error?(h(),m("div",ve,[r("div",ye,[(h(!0),m(P,null,I(o.products,(a,y)=>(h(),m("div",{ref_for:!0,ref:"product-card",id:"product-card",class:"col-6 col-md-4 col-lg-4",key:y,onClick:R=>s.showProductInfo(a)},[c(T,{class:"h-100 w-100",product:a},null,8,["product"])],8,Pe))),128))]),r("div",be,[Se,c(O,{class:"col-md-8",numberPages:o.pageSum,currentPage:i.currentPage,onOnSelectPage:s.onSelectPage},null,8,["numberPages","currentPage","onOnSelectPage"])])])):b("",!0)])])]),o.isFilterNavShow?(h(),m("div",Fe)):b("",!0),c(U,{name:"slide"},{default:H(()=>[w(r("div",Ce,[r("button",{class:"nav__close-btn",onClick:t[6]||(t[6]=a=>o.isFilterNavShow=!1)},[c(u,{icon:"xmark",size:"2x",style:{color:"white"}})]),we,r("div",Ie,[c(l,{category:i.category,filterItemRemove:o.filterItemRemove,onOnFilterItemClick:s.onFilterItemClick,onOnFilterValueChange:s.onFilterValueChange},null,8,["category","filterItemRemove","onOnFilterItemClick","onOnFilterValueChange"])])],512),[[W,o.isFilterNavShow]])]),_:1}),c(V)],64)}const ze=B(re,[["render",xe],["__scopeId","data-v-7f505a0b"]]);export{ze as default};
